{% extends "base.html.twig" %}
{% block title %}
	{{app.user.name}}
{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" type="text/css" href="../style/styleProfil.css">
{% endblock %}


{% block body %}
	<style>
		@import url('https://fonts.googleapis.com/css?family=Poppins:300, 400, 500, 600, 700, 800, 900 &display=swap');
		@import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Concert+One&display=swap');
		* {
			font-family: 'Poppins', sans-serif;
			margin: 0;
			color: white;
		}
		body {
			background-image: url('https://downloadwap.com/thumbs2/wallpapers/p2ls/2019/movies/36/9c3533c613349257.jpg');
		}
		#tout {
			background-color: rgba(0, 0, 0, 0.534);
			height: fit-content;
			padding-bottom: 2%;
		}
		header {
			display: flex;
			justify-content: space-between;
			background: linear-gradient(black 10%, transparent);
		}
		header * {
			margin: 2%;
		}
		header .title {
			color: #f44336;
			font-family: 'Bebas Neue', sans-serif;
			font-size: 3vw;
			letter-spacing: 4px;
			text-shadow: 5px 3px 10px rgb(0, 0, 0);
			text-decoration: none;
		}
		#titre {
			font-family: 'Concert One', cursive;
			font-size: 4vw;
			text-shadow: 5px 3px 10px rgb(0, 0, 0);
			text-decoration: bold;
		}
		.infos-utilisateur {
			display: flex;
			justify-content: center;
			align-items: center;
			margin: 0 30% 2%;
			background-color: rgba(0, 0, 0, 0.80);
			border-radius: 50px;
		}
		.checkbox {
			display: flex;
		}
		.resume {
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		.avatar {
			width: 100px;
			height: 100px;
			border-radius: 50%;
			overflow: hidden;
		}

		.avatar img {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}
		.infos-utilisateur * {
			margin: 5%;
		}
		.compte {
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		.formulaire {
			display: flex;
			flex-direction: column;
		}
		.formulaire * {
			margin: 2%;
		}
		.submit {
			display: flex;
		}
		input,
		select {
			color: black;
		}
		.info p.label {
			text-decoration: underline;
		}
		.contenu {
			display: flex;
			flex-direction: column;
			justify-content: center;
			margin: 0 5%;
			background-color: rgba(0, 0, 0, 0.80);
			border-radius: 50px;
		}
		.contenu * {
			margin: 1% 1% 0;
		}
		.serie {
			margin: 5%;
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		#afficheSeries {
			display: flex;
		}
		#afficheSeries .bouton {
			margin: 2%;
		}
		td img {
			height: 400px;
		}
		button,
		.bouton {
			background-color: #f44336;
			border: none;
			color: black;
			padding: 10px 25px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			border-radius: 4px;
			margin-right: 10%;
			cursor: pointer;
		}
		button {
			background-color: #37cf51;
		}
		.stop {
			margin-top: 8.5%;
			height: 43px;
		}
	</style>

	<div id="tout">
		<header>
			<a href="{{path('app_default')}}" class="title">Netflop</a>
			<div id="id">
				{% include 'header.html.twig' %}
			</div>
		</header>
		<div class="infos-utilisateur">
			<div class="resume">
				<div class="avatar">
					{% if user.photo is not null %}
						<img width="150px" src="{{ path('photo_user', {'id': user.id} ) }}">
					{% else %}
						<img width="150px" src="../images/avatar.png">
					{% endif %}
				</div>
				<span>{{user.name}}</span>
				<span>{{user.email}}</span>
				<span></span>
				<a href="{{ path('app_series_index')}}">
					<button class="bouton" type="button">Retour</button>
				</a>
			</div>
			<div class="compte">
				{% if user == app.user %}
					<h3>Mon compte</h3>
				{% else %}
					<h3>Utilisateur</h3>
				{% endif %}
				<div class="info">
					<p class="label">Nom :</p>
					<p>{{user.name}}</p>
					<p class="label">Email :</p>
					<p>{{user.email}}</p>
					<p class="label">Pays :</p>
					<p>{{user.country}}</p>
				</div>
				{% if is_granted('IS_IMPERSONATOR') %}
					{% else %}
						<div class="frorm">
							<div class="formulaire">
								{{form_start(form)}}
								<p>Nom</p>
								{{form_row(form.name)}}
								<p>Email</p>
								{{form_row(form.email)}}
								<p>Pays</p>
								{{form_row(form.country)}}
								<p>Mot de passe</p>
								{{form_row(form.plainPassword)}}
								<p>Photo de profil</p>
								{{form_row(form.photo)}}
								<div class="checkbox">
									<label>Valider</label>
									{{form_row(form.agreeTerms)}}
								</div>
							</div>
							<div class="modifier-annuler">
								<div class="submit">
									{{form_row(form.submit)}}
									<button class="bouton stop" type="button">Annuler</button>
								</div>
							</div>
							{{form_end(form)}}
						</div>
						{% if user == app.user %}
							<button class="bouton profile-button" type="button">Modifier</button>
						{% endif %}
				{% endif %}
			</div>
		</div>
		<div class="contenu">
			<div id="critiques">
				<h2>Récapitulatifs des critiques</h2>
				{% for rating in ratings %}
					<div class="bloc_critique">
						<p>{{ rating.comment }}</p>
						<p>{{ rating.value }}</p>
						<p>------------</p>
					</div>
				{% else %}
					<p>Aucune critique trouvée.</p>
				{% endfor %}
			</div>
			<div id="series-favorites">
				<h2>Séries favorites</h2>
				<table class="table">
					<tbody id="afficheSeries">
						{% for series in user.series %}
							<tr class="serie">
								<td>
									<img src="{{ path('poster_series_show', {'id': series.id} ) }}"/>
								</td>
								<td>{{ series.title }}</td>
								<td>
									<a class="bouton" href="{{ path('app_series_show', {'id': series.id}) }}">Afficher</a>
								</td>
								{% if user == app.user %}
									<td>
										<a class="bouton" href="{{ path('app_series_show_adds', {'series': series.id, 'yesno': "0", 'redirect': "0" }) }}">Supprimer</a>
									</td>
								{% endif %}

							</tr>
						{% else %}
							<tr>
								<td colspan="11">Aucune série trouvée.</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			<div id="historique">
				<h2>Épisodes vus</h2>
				<table class="table">
					<tbody id="afficheSeries">
						{% for episode in user.episode %}
							<tr class="serie">
								<td>
									<img src="{{ path('poster_series_show', {'id': episode.season.series.id} ) }}"/>
								</td>
								<td>{{ episode.season.series.title }}</td>
								<td>Épisode
									{{ episode.number }}</td>
								<td>"{{ episode.title }}"</td>
								<td>
									<a class="bouton" href="{{ path('app_series_show', {'id': episode.season.series.id}) }}">Afficher</a>
								</td>
								{% if user == app.user %}
									<td>
										<a class="bouton" href="{{ path('app_series_show_seen_adds', {'series': episode.season.series.id, 'episode': episode.id, 'yesno': "0"}) }}">Supprimer</a>
									</td>
								{% endif %}
							</tr>
						{% else %}
							<tr>
								<td colspan="11">Aucun épisode trouvé.</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<script>
		var country = document.querySelector('select');
country.value = {{ user.country.id }};

var form = document.querySelector('.frorm').style.display = 'none';
var div = document.querySelector('.info').style.display = 'block';
var stop = document.querySelector('.stop').style.display = 'none';
var button = document.querySelector('.profile-button');
button.addEventListener('click', function () {
stop = document.querySelector('.stop').style.display = 'block';
form = document.querySelector('.frorm').style.display = 'block';
div = document.querySelector('.info').style.display = 'none';
button.style.display = 'none';
})

var stop = document.querySelector('.stop');
stop.addEventListener('click', function () {
stop = document.querySelector('.stop').style.display = 'none';
form = document.querySelector('.frorm').style.display = 'none';
div = document.querySelector('.info').style.display = 'block';
button.style.display = 'block';
})

var input = document.querySelector('input[type=file]');
input.addEventListener('change', function () {
var file = this.files[0];
var reader = new FileReader();
reader.addEventListener('load', function () {
var img = document.querySelector('img');
img.src = reader.result;
});
reader.readAsDataURL(file);
})

var submit = document.querySelector('.submit');
submit.style.marginRight = '10px';
	</script>

{% endblock %}
